<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>quaterion.train.trainable_model module &mdash; Quaterion  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/quaterion.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="quaterion.utils package" href="quaterion.utils.html" />
    <link rel="prev" title="quaterion.train.cache.cache_config module" href="quaterion.train.cache.cache_config.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Quaterion
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="quaterion.html">quaterion package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="quaterion.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="quaterion.dataset.html">quaterion.dataset package</a></li>
<li class="toctree-l3"><a class="reference internal" href="quaterion.eval.html">quaterion.eval package</a></li>
<li class="toctree-l3"><a class="reference internal" href="quaterion.loss.html">quaterion.loss package</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="quaterion.train.html">quaterion.train package</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="quaterion.train.html#subpackages">Subpackages</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="quaterion.train.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="quaterion.train.html#module-quaterion.train">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="quaterion.utils.html">quaterion.utils package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="quaterion.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="quaterion.html#module-quaterion">Module contents</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Quaterion</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="quaterion.html">quaterion package</a> &raquo;</li>
          <li><a href="quaterion.train.html">quaterion.train package</a> &raquo;</li>
      <li>quaterion.train.trainable_model module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/quaterion.train.trainable_model.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-quaterion.train.trainable_model">
<span id="quaterion-train-trainable-model-module"></span><h1>quaterion.train.trainable_model module<a class="headerlink" href="#module-quaterion.train.trainable_model" title="Permalink to this headline"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="quaterion.train.trainable_model.TrainableModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">TrainableModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/quaterion/train/trainable_model.html#TrainableModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#quaterion.train.trainable_model.TrainableModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">LightningModule</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">CacheMixin</span></code></p>
<p>Base class for models to be trained.</p>
<dl class="py method">
<dt class="sig sig-object py" id="quaterion.train.trainable_model.TrainableModel.cache">
<span class="sig-name descname"><span class="pre">cache</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Trainer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dataloader</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="quaterion.dataset.similarity_data_loader.html#quaterion.dataset.similarity_data_loader.SimilarityDataLoader" title="quaterion.dataset.similarity_data_loader.SimilarityDataLoader"><span class="pre">SimilarityDataLoader</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_dataloader</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="quaterion.dataset.similarity_data_loader.html#quaterion.dataset.similarity_data_loader.SimilarityDataLoader" title="quaterion.dataset.similarity_data_loader.SimilarityDataLoader"><span class="pre">SimilarityDataLoader</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/quaterion/train/trainable_model.html#TrainableModel.cache"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#quaterion.train.trainable_model.TrainableModel.cache" title="Permalink to this definition"></a></dt>
<dd><p>Fill cachable encoders with embeddings</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="quaterion.train.trainable_model.TrainableModel.configure_caches">
<span class="sig-name descname"><span class="pre">configure_caches</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="quaterion.train.cache.cache_config.html#quaterion.train.cache.cache_config.CacheConfig" title="quaterion.train.cache.cache_config.CacheConfig"><span class="pre">CacheConfig</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/quaterion/train/trainable_model.html#TrainableModel.configure_caches"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#quaterion.train.trainable_model.TrainableModel.configure_caches" title="Permalink to this definition"></a></dt>
<dd><p>Method to provide cache configuration</p>
<p>Use this method to define which encoders should cache calculated embeddings and
what kind of cache they should use.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Optional[<a class="reference internal" href="quaterion.train.cache.cache_config.html#quaterion.train.cache.cache_config.CacheConfig" title="quaterion.train.cache.cache_config.CacheConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">CacheConfig</span></code></a>] – cache configuration
to be applied if provided, None otherwise.</p>
</dd>
</dl>
<p>Examples:</p>
<p><cite>Do not use cache (default)</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">return</span> <span class="kc">None</span>
</pre></div>
</div>
<p><cite>Configure cache automatically for all non-trainable encoders</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">return</span> <span class="n">CacheConfig</span><span class="p">(</span><span class="n">CacheType</span><span class="o">.</span><span class="n">AUTO</span><span class="p">)</span>
</pre></div>
</div>
<p><cite>Specify cache type for each encoder individually</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">return</span> <span class="n">CacheConfig</span><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;text_encoder&quot;</span><span class="p">:</span> <span class="n">CacheType</span><span class="o">.</span><span class="n">GPU</span><span class="p">,</span>
        <span class="c1"># Store cache in GPU for `text_encoder`</span>
        <span class="s2">&quot;image_encoder&quot;</span><span class="p">:</span> <span class="n">CacheType</span><span class="o">.</span><span class="n">CPU</span>
        <span class="c1"># Store cache in RAM for `image_encoder`</span>
    <span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
<p><cite>Specify key for cache object disambiguation</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">return</span> <span class="n">CacheConfig</span><span class="p">(</span>
    <span class="n">cache_type</span><span class="o">=</span><span class="n">CacheType</span><span class="o">.</span><span class="n">AUTO</span><span class="p">,</span>
    <span class="n">key_extractors</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;text_encoder&quot;</span><span class="p">:</span> <span class="nb">hash</span><span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
<p>This function might be useful if you want to provide some more sophisticated way of
storing association between cached vectors and original object.
Item numbers from dataset
will be used by default if key is not specified.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="quaterion.train.trainable_model.TrainableModel.configure_encoders">
<span class="sig-name descname"><span class="pre">configure_encoders</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Encoder</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Encoder</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/quaterion/train/trainable_model.html#TrainableModel.configure_encoders"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#quaterion.train.trainable_model.TrainableModel.configure_encoders" title="Permalink to this definition"></a></dt>
<dd><p>Method to provide encoders configuration</p>
<p>Use this function to define an initial state of encoders.
This function should be used to assign initial values for encoders
before training as well as during the checkpoint loading.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Union[<code class="xref py py-class docutils literal notranslate"><span class="pre">Encoder</span></code>,
Dict[str, <code class="xref py py-class docutils literal notranslate"><span class="pre">Encoder</span></code>]]:
instance of encoder which will be assigned to
<code class="xref py py-const docutils literal notranslate"><span class="pre">DEFAULT_ENCODER_KEY</span></code>, or mapping of names and
encoders.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="quaterion.train.trainable_model.TrainableModel.configure_head">
<span class="sig-name descname"><span class="pre">configure_head</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_embedding_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">EncoderHead</span></span></span><a class="reference internal" href="_modules/quaterion/train/trainable_model.html#TrainableModel.configure_head"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#quaterion.train.trainable_model.TrainableModel.configure_head" title="Permalink to this definition"></a></dt>
<dd><p>Use this function to define an initial state for head layer of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input_embedding_size</strong> – size of embeddings produced by encoders</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">EncoderHead</span></code> – head to be added on top of
a model</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="quaterion.train.trainable_model.TrainableModel.configure_loss">
<span class="sig-name descname"><span class="pre">configure_loss</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="quaterion.loss.similarity_loss.html#quaterion.loss.similarity_loss.SimilarityLoss" title="quaterion.loss.similarity_loss.SimilarityLoss"><span class="pre">SimilarityLoss</span></a></span></span><a class="reference internal" href="_modules/quaterion/train/trainable_model.html#TrainableModel.configure_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#quaterion.train.trainable_model.TrainableModel.configure_loss" title="Permalink to this definition"></a></dt>
<dd><p>Method to configure loss function to use.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="quaterion.train.trainable_model.TrainableModel.process_results">
<span class="sig-name descname"><span class="pre">process_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embeddings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="quaterion.utils.enums.html#quaterion.utils.enums.TrainStage" title="quaterion.utils.enums.TrainStage"><span class="pre">TrainStage</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/quaterion/train/trainable_model.html#TrainableModel.process_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#quaterion.train.trainable_model.TrainableModel.process_results" title="Permalink to this definition"></a></dt>
<dd><p>Method to provide any additional evaluations of embeddings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>embeddings</strong> – shape: (batch_size, embedding_size) - model’s output.</p></li>
<li><p><strong>targets</strong> – output of batch target collate.</p></li>
<li><p><strong>batch_idx</strong> – ID of the processing batch.</p></li>
<li><p><strong>stage</strong> – train, validation or test stage.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="quaterion.train.trainable_model.TrainableModel.save_servable">
<span class="sig-name descname"><span class="pre">save_servable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/quaterion/train/trainable_model.html#TrainableModel.save_servable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#quaterion.train.trainable_model.TrainableModel.save_servable" title="Permalink to this definition"></a></dt>
<dd><p>Save model for serving, independent of Pytorch Lightning</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> – path to save to</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="quaterion.train.trainable_model.TrainableModel.setup_dataloader">
<span class="sig-name descname"><span class="pre">setup_dataloader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataloader</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="quaterion.dataset.similarity_data_loader.html#quaterion.dataset.similarity_data_loader.SimilarityDataLoader" title="quaterion.dataset.similarity_data_loader.SimilarityDataLoader"><span class="pre">SimilarityDataLoader</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/quaterion/train/trainable_model.html#TrainableModel.setup_dataloader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#quaterion.train.trainable_model.TrainableModel.setup_dataloader" title="Permalink to this definition"></a></dt>
<dd><p>Update data loader’s collate function with encoder-specific collate</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="quaterion.train.trainable_model.TrainableModel.test_step">
<span class="sig-name descname"><span class="pre">test_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/quaterion/train/trainable_model.html#TrainableModel.test_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#quaterion.train.trainable_model.TrainableModel.test_step" title="Permalink to this definition"></a></dt>
<dd><p>Compute test loss and some additional metrics for e.g. the progress
bar or logger.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> – Output of DataLoader.</p></li>
<li><p><strong>batch_idx</strong> – Integer displaying index of this batch.</p></li>
<li><p><strong>**kwargs</strong> – keyword arguments to be passed into <a class="reference internal" href="#quaterion.train.trainable_model.TrainableModel.process_results" title="quaterion.train.trainable_model.TrainableModel.process_results"><code class="xref py py-meth docutils literal notranslate"><span class="pre">process_results()</span></code></a></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="quaterion.train.trainable_model.TrainableModel.training_step">
<span class="sig-name descname"><span class="pre">training_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TensorInterchange</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/quaterion/train/trainable_model.html#TrainableModel.training_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#quaterion.train.trainable_model.TrainableModel.training_step" title="Permalink to this definition"></a></dt>
<dd><p>Compute and return the training loss and some additional metrics for e.g.
the progress bar or logger.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> – Output of DataLoader.</p></li>
<li><p><strong>batch_idx</strong> – Integer displaying index of this batch.</p></li>
<li><p><strong>**kwargs</strong> – keyword arguments to be passed into <a class="reference internal" href="#quaterion.train.trainable_model.TrainableModel.process_results" title="quaterion.train.trainable_model.TrainableModel.process_results"><code class="xref py py-meth docutils literal notranslate"><span class="pre">process_results()</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>Tensor</em> – computed loss value</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="quaterion.train.trainable_model.TrainableModel.unwrap_cache">
<span class="sig-name descname"><span class="pre">unwrap_cache</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/quaterion/train/trainable_model.html#TrainableModel.unwrap_cache"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#quaterion.train.trainable_model.TrainableModel.unwrap_cache" title="Permalink to this definition"></a></dt>
<dd><p>Restore original encoders</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="quaterion.train.trainable_model.TrainableModel.validation_step">
<span class="sig-name descname"><span class="pre">validation_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/quaterion/train/trainable_model.html#TrainableModel.validation_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#quaterion.train.trainable_model.TrainableModel.validation_step" title="Permalink to this definition"></a></dt>
<dd><p>Compute validation loss and some additional metrics for e.g. the progress
bar or logger.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> – Output of DataLoader.</p></li>
<li><p><strong>batch_idx</strong> – Integer displaying index of this batch.</p></li>
<li><p><strong>**kwargs</strong> – keyword arguments to be passed into <a class="reference internal" href="#quaterion.train.trainable_model.TrainableModel.process_results" title="quaterion.train.trainable_model.TrainableModel.process_results"><code class="xref py py-meth docutils literal notranslate"><span class="pre">process_results()</span></code></a></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="quaterion.train.trainable_model.TrainableModel.loss">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">loss</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="quaterion.loss.similarity_loss.html#quaterion.loss.similarity_loss.SimilarityLoss" title="quaterion.loss.similarity_loss.SimilarityLoss"><span class="pre">SimilarityLoss</span></a></em><a class="headerlink" href="#quaterion.train.trainable_model.TrainableModel.loss" title="Permalink to this definition"></a></dt>
<dd><p>Property to get the loss function to use.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="quaterion.train.trainable_model.TrainableModel.model">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">quaterion_models.model.MetricModel</span></em><a class="headerlink" href="#quaterion.train.trainable_model.TrainableModel.model" title="Permalink to this definition"></a></dt>
<dd><p>Origin model to be trained</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">MetricModel</span></code> – model to be trained</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="quaterion.train.trainable_model.TrainableModel.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#quaterion.train.trainable_model.TrainableModel.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="quaterion.train.cache.cache_config.html" class="btn btn-neutral float-left" title="quaterion.train.cache.cache_config module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="quaterion.utils.html" class="btn btn-neutral float-right" title="quaterion.utils package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Quaterion Authors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>